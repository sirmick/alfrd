[supervisord]
nodaemon=true
user=esec
logfile=/data/logs/supervisord.log
pidfile=/tmp/supervisord.pid
childlogdir=/data/logs

[program:api-server]
command=python -m uvicorn api_server.main:app --host 0.0.0.0 --port 8000
directory=/app/api-server/src
autostart=true
autorestart=true
stderr_logfile=/data/logs/api-server.err.log
stdout_logfile=/data/logs/api-server.out.log
environment=PYTHONUNBUFFERED=1,PYTHONPATH=/app

[program:mcp-server]
command=python -m mcp_server.main
directory=/app/mcp-server/src
autostart=true
autorestart=true
stderr_logfile=/data/logs/mcp-server.err.log
stdout_logfile=/data/logs/mcp-server.out.log
environment=PYTHONUNBUFFERED=1,PYTHONPATH=/app

[program:doc-processor-watcher]
command=python -m document_processor.watcher
directory=/app/document-processor/src
autostart=true
autorestart=true
stderr_logfile=/data/logs/doc-watcher.err.log
stdout_logfile=/data/logs/doc-watcher.out.log
environment=PYTHONUNBUFFERED=1,PYTHONPATH=/app

[program:doc-processor-batch]
command=python -m document_processor.main
directory=/app/document-processor/src
autostart=false
autorestart=false
stderr_logfile=/data/logs/doc-batch.err.log
stdout_logfile=/data/logs/doc-batch.out.log
environment=PYTHONUNBUFFERED=1,PYTHONPATH=/app

[program:web-ui]
command=python -m http.server 8080 --directory /app/web-ui/dist
directory=/app/web-ui
autostart=false
autorestart=true
stderr_logfile=/data/logs/web-ui.err.log
stdout_logfile=/data/logs/web-ui.out.log
environment=PYTHONUNBUFFERED=1