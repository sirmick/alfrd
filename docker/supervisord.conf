[supervisord]
nodaemon=true
user=esec
logfile=/data/logs/supervisord.log
pidfile=/tmp/supervisord.pid
loglevel=info

[program:api-server]
command=python -m api_server.main
directory=/app/api-server
autostart=true
autorestart=true
stderr_logfile=/data/logs/api-server.err.log
stdout_logfile=/data/logs/api-server.out.log
environment=PYTHONUNBUFFERED=1
priority=10

[program:mcp-server]
command=python -m mcp_server.main
directory=/app/mcp-server
autostart=true
autorestart=true
stderr_logfile=/data/logs/mcp-server.err.log
stdout_logfile=/data/logs/mcp-server.out.log
environment=PYTHONUNBUFFERED=1
priority=20

[program:doc-processor-watcher]
command=python -m document_processor.watcher
directory=/app/document-processor
autostart=true
autorestart=true
stderr_logfile=/data/logs/doc-watcher.err.log
stdout_logfile=/data/logs/doc-watcher.out.log
environment=PYTHONUNBUFFERED=1
priority=30

[program:doc-processor-batch]
command=python -m document_processor.main
directory=/app/document-processor
autostart=false
autorestart=false
stderr_logfile=/data/logs/doc-batch.err.log
stdout_logfile=/data/logs/doc-batch.out.log
environment=PYTHONUNBUFFERED=1
priority=40

# Web UI in dev mode (single container)
[program:web-ui]
command=python -m http.server 8080 -d /app/web-ui/dist
directory=/app/web-ui
autostart=false
autorestart=true
stderr_logfile=/data/logs/web-ui.err.log
stdout_logfile=/data/logs/web-ui.out.log
environment=PYTHONUNBUFFERED=1
priority=50